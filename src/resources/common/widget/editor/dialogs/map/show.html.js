define(function(require, exports, module) {
    module.exports="<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\r\n \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n<head>\r\n <meta charset=\"utf-8\"/>\r\n <meta name=\"keywords\" content=\"百度地图,百度地图API，百度地图自定义工具，百度地图所见即所得工具\"/>\r\n <meta name=\"description\" content=\"百度地图API自定义地图，帮助用户在可视化操作下生成百度地图\"/>\r\n <title>百度地图API自定义地图</title>\r\n <!--引用百度地图API-->\r\n <style type=\"text/css\">\r\n html, body {\r\n margin: 0;\r\n padding: 0;\r\n overflow: hidden;\r\n }\r\n </style>\r\n <script type=\"text/javascript\" src=\"http://api.map.baidu.com/api?key=&v=1.1&services=true\"></script>\r\n</head>\r\n\r\n<body onload=\"initMap();\">\r\n<!--百度地图容器-->\r\n<div style=\"width:697px;height:550px;border:#ccc solid 1px;\" id=\"dituContent\"></div>\r\n</body>\r\n<script type=\"text/javascript\">\r\n function getParam(name) {\r\n return location.href.match(new RegExp('[?#&]' + name + '=([^?#&]+)', 'i')) ? RegExp.$1 : '';\r\n }\r\n var map, marker;\r\n var centerParam = getParam('center');\r\n var zoomParam = getParam('zoom');\r\n var widthParam = getParam('width');\r\n var heightParam = getParam('height');\r\n var markersParam = getParam('markers');\r\n var markerStylesParam = getParam('markerStyles');\r\n\r\n //创建和初始化地图函数：\r\n function initMap() {\r\n // [FF]切换模式后报错\r\n if (!window.BMap) {\r\n return;\r\n }\r\n var dituContent = document.getElementById('dituContent');\r\n dituContent.style.width = widthParam + 'px';\r\n dituContent.style.height = heightParam + 'px';\r\n\r\n createMap();//创建地图\r\n setMapEvent();//设置地图事件\r\n addMapControl();//向地图添加控件\r\n\r\n // 创建标注\r\n var markersArr = markersParam.split(',');\r\n var point = new BMap.Point(markersArr[0], markersArr[1]);\r\n marker = new BMap.Marker(point);\r\n marker.enableDragging();\r\n map.addOverlay(marker); // 将标注添加到地图中\r\n\r\n if(parent.editor && parent.document.body.contentEditable==\"true\") { //在编辑状态下\r\n setMapListener();//地图改变修改外层的iframe标签src属性\r\n }\r\n }\r\n\r\n //创建地图函数：\r\n function createMap() {\r\n map = new BMap.Map(\"dituContent\");//在百度地图容器中创建一个地图\r\n var centerArr = centerParam.split(',');\r\n var point = new BMap.Point(parseFloat(centerArr[0]), parseFloat(centerArr[1]));//定义一个中心点坐标\r\n map.centerAndZoom(point, parseInt(zoomParam));//设定地图的中心点和坐标并将地图显示在地图容器中\r\n }\r\n\r\n //地图事件设置函数：\r\n function setMapEvent() {\r\n map.enableDragging();//启用地图拖拽事件，默认启用(可不写)\r\n map.enableScrollWheelZoom();//启用地图滚轮放大缩小\r\n map.enableDoubleClickZoom();//启用鼠标双击放大，默认启用(可不写)\r\n map.enableKeyboard();//启用键盘上下左右键移动地图\r\n }\r\n\r\n //地图控件添加函数：\r\n function addMapControl() {\r\n //向地图中添加缩放控件\r\n var ctrl_nav = new BMap.NavigationControl({anchor: BMAP_ANCHOR_TOP_LEFT, type: BMAP_NAVIGATION_CONTROL_LARGE});\r\n map.addControl(ctrl_nav);\r\n //向地图中添加缩略图控件\r\n var ctrl_ove = new BMap.OverviewMapControl({anchor: BMAP_ANCHOR_BOTTOM_RIGHT, isOpen: 1});\r\n map.addControl(ctrl_ove);\r\n //向地图中添加比例尺控件\r\n var ctrl_sca = new BMap.ScaleControl({anchor: BMAP_ANCHOR_BOTTOM_LEFT});\r\n map.addControl(ctrl_sca);\r\n }\r\n\r\n function setMapListener() {\r\n var editor = parent.editor, containerIframe,\r\n iframes = parent.document.getElementsByTagName('iframe');\r\n for (var key in iframes) {\r\n if (iframes[key].contentWindow == window) {\r\n containerIframe = iframes[key];\r\n break;\r\n }\r\n }\r\n if (containerIframe) {\r\n map.addEventListener('moveend', mapListenerHandler);\r\n map.addEventListener('zoomend', mapListenerHandler);\r\n marker.addEventListener('dragend', mapListenerHandler);\r\n }\r\n\r\n function mapListenerHandler() {\r\n var zoom = map.getZoom(),\r\n center = map.getCenter(),\r\n marker = window.marker.getPoint();\r\n containerIframe.src = containerIframe.src.\r\n replace(new RegExp('([?#&])center=([^?#&]+)', 'i'), '$1center=' + center.lng + ',' + center.lat).\r\n replace(new RegExp('([?#&])markers=([^?#&]+)', 'i'), '$1markers=' + marker.lng + ',' + marker.lat).\r\n replace(new RegExp('([?#&])zoom=([^?#&]+)', 'i'), '$1zoom=' + zoom);\r\n editor.fireEvent('saveScene');\r\n }\r\n }\r\n</script>\r\n</html>";
});