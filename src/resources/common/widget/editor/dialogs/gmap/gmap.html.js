define(function(require, exports, module) {
    module.exports="<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"\r\n \"http://www.w3.org/TR/html4/loose.dtd\">\r\n<html>\r\n<head>\r\n <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\r\n <title></title>\r\n <script type=\"text/javascript\" src=\"../internal.js\"></script>\r\n <style type=\"text/css\">\r\n .content{width:530px; height: 350px;margin: 10px auto;}\r\n .content table{width: 100%}\r\n .content table td{vertical-align: middle;}\r\n #address{width:220px;height:21px;background: #FFF;border:1px solid #d7d7d7; line-height: 21px;}\r\n </style>\r\n <script type=\"text/javascript\" src=\"http://maps.googleapis.com/maps/api/js?sensor=false\"></script>\r\n</head>\r\n<body>\r\n<div class=\"content\">\r\n <table>\r\n <tr>\r\n <td><label for=\"address\"><var id=\"lang_input_address\"></var></label></td>\r\n <td><input id=\"address\" type=\"text\" /></td>\r\n <td><a id=\"doSearch\" href=\"javascript:void(0)\" class=\"button\"><var id=\"lang_input_search\"></var></a></td>\r\n </tr>\r\n </table>\r\n <div id=\"container\" style=\"width: 100%; height: 340px;margin: 5px auto; border: 1px solid gray;\"></div>\r\n</div>\r\n<script type=\"text/javascript\">\r\n domUtils.on(window,\"load\",function(){\r\n var map = new google.maps.Map(document.getElementById('container'), {\r\n zoom: 3,\r\n streetViewControl: false,\r\n scaleControl: true,\r\n mapTypeId: google.maps.MapTypeId.ROADMAP\r\n });\r\n var imgcss;\r\n var marker = new google.maps.Marker({\r\n map: map,\r\n draggable: true\r\n });\r\n function doSearch(){\r\n var address = document.getElementById('address').value;\r\n var geocoder = new google.maps.Geocoder();\r\n geocoder.geocode( { 'address': address}, function (results, status) {\r\n if (status == google.maps.GeocoderStatus.OK) {\r\n var bounds = results[0].geometry.viewport;\r\n map.fitBounds(bounds);\r\n marker.setPosition(results[0].geometry.location);\r\n marker.setTitle(address);\r\n } else alert(lang.searchError);\r\n });\r\n }\r\n $G('address').onkeydown = function (evt){\r\n evt = evt || event;\r\n if (evt.keyCode == 13) {\r\n doSearch();\r\n }\r\n };\r\n $G(\"doSearch\").onclick = doSearch;\r\n dialog.onok = function (){\r\n var center = map.getCenter();\r\n var point = marker.getPosition();\r\n var url = \"http://maps.googleapis.com/maps/api/staticmap?center=\" + center.lat() + ',' + center.lng() + \"&zoom=\" + map.zoom + \"&size=520x340&maptype=\" + map.getMapTypeId() + \"&markers=\" + point.lat() + ',' + point.lng() + \"&sensor=false\";\r\n editor.execCommand('inserthtml', '<img width=\"520\" height=\"340\" src=\"' + url + '\"' + (imgcss ? ' style=\"' + imgcss + '\"' :'') + '/>');\r\n };\r\n\r\n function getPars(str,par){\r\n var reg = new RegExp(par+\"=((\\\\d+|[.,])*)\",\"g\");\r\n return reg.exec(str)[1];\r\n }\r\n var img = editor.selection.getRange().getClosedNode();\r\n if(img && img.src.indexOf(\"http://maps.googleapis.com/maps/api/staticmap\")!=-1){\r\n var url = img.getAttribute(\"src\");\r\n var centers = getPars(url,\"center\").split(\",\");\r\n point = new google.maps.LatLng(Number(centers[0]),Number(centers[1]));\r\n map.setCenter(point);\r\n map.setZoom(Number(getPars(url,\"zoom\")));\r\n centers = getPars(url,\"markers\").split(\",\");\r\n marker.setPosition(new google.maps.LatLng(Number(centers[0]),Number(centers[1])));\r\n imgcss = img.style.cssText;\r\n }else{\r\n setTimeout(function(){\r\n doSearch();\r\n },30)\r\n }\r\n });\r\n\r\n</script>\r\n</body>\r\n</html>";
});